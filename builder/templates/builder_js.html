{% load static %}
{% load react_builder %}
<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <link rel="shortcut icon" href="{% static 'builder-react' %}/favicon.ico">
        <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
        <meta name="theme-color" content="#000000">
        <link rel="manifest" href="{% static 'builder-react' %}/manifest.json">

        <link rel="stylesheet" href="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.css" />
        <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">

        <title>SMS Builder</title>
        <style>
            body {
                display: flex;
                height: 100vh;
                margin: 0px;
            }

            .mdc-drawer-app-content {
                flex: auto;
                overflow: auto;
                position: relative;
            }

            .main-content {
                overflow: auto;
                height: 100%;
            }

            .app-bar {
                position: absolute;
                z-index: 10;
            }

            .mdc-top-app-bar {
                z-index: 7;
            }
            
            a {
            	text-decoration: none;
            }
        </style>
        
    </head>
    <body class="mdc-typography">
        <header class="mdc-top-app-bar app-bar mdc-top-app-bar--fixed" id="app-bar">
            <div class="mdc-top-app-bar__row">
                <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-start">
                    <a href="#" class="demo-menu material-icons mdc-top-app-bar__navigation-icon">menu</a>
                    <span class="mdc-top-app-bar__title">SMS Builder</span>
                </section>
                <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-end" role="toolbar">
                    <a href="#" class="material-icons mdc-top-app-bar__action-item" aria-label="Save" id="action_save">save</a>
                </section>
            </div>
        </header>
        <aside class="mdc-drawer mdc-drawer--dismissible mdc-top-app-bar--fixed-adjust">
            <div class="mdc-drawer__content">
                <div class="mdc-list" id="sequences_list">
                    <a class="mdc-list-item mdc-list-item--activated" href="#" aria-current="page">
                        <i class="material-icons mdc-list-item__graphic" aria-hidden="true">inbox</i>
                        <span class="mdc-list-item__text">Inbox</span>
                    </a>
                    <a class="mdc-list-item" href="#">
                        <i class="material-icons mdc-list-item__graphic" aria-hidden="true">send</i>
                        <span class="mdc-list-item__text">Outgoing</span>
                    </a>
                    <a class="mdc-list-item" href="#">
                        <i class="material-icons mdc-list-item__graphic" aria-hidden="true">drafts</i>
                        <span class="mdc-list-item__text">Drafts</span>
                    </a>
                </div>
            </div>
        </aside>

        <div class="mdc-drawer-app-content mdc-top-app-bar--fixed-adjust"  style="background-color: #BDBDBD;">
            <main class="main-content" id="main-content">
                <div class="mdc-layout-grid">
                    <div class="mdc-layout-grid__inner">
                        <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12" style="padding-bottom: 16px;">
                            <span class="mdc-typography--caption" id="sequence_breadcrumbs"></span>
                        </div>
                    </div>
                    <div class="mdc-layout-grid__inner">
                        <div class="mdc-layout-grid__cell" style="padding-bottom: 16px;">
                            <span class="mdc-typography--subtitle2" id="sources_list">Sources</span>
                        </div>
                        <div class="mdc-layout-grid__cell" style="padding-bottom: 16px;">
                            <span class="mdc-typography--subtitle2">Current</span>
                        </div>
                        <div class="mdc-layout-grid__cell" style="padding-bottom: 16px;">
                            <span class="mdc-typography--subtitle2">Destinations</span>
                        </div>
                    </div>
                    <div class="mdc-layout-grid__inner">
                        <div class="mdc-layout-grid__cell" id="builder_source_nodes">
                            (Sources Here)
                        </div>
                        <div class="mdc-layout-grid__cell" id="builder_current_node"></div>
                        <div class="mdc-layout-grid__cell" id="builder_next_nodes">
                            (Destinations Here)
                        </div>
                    </div>
                </div>
            </main>
        </div>

		<div class="mdc-dialog" role="alertdialog" aria-modal="true" id="add-card-dialog"  aria-labelledby="add-card-dialog-title" aria-describedby="add-card-dialog-content">
			<div class="mdc-dialog__container">
				<div class="mdc-dialog__surface">
					<h2 class="mdc-dialog__title" id="add-card-dialog-title">Add Card</h2>
					<div class="mdc-dialog__content" id="add-card-dialog-content">
						<div class="mdc-text-field mdc-text-field--outlined" id="add-card-name"  style="width: 100%; margin-top: 8px;">
							<input type="text" class="mdc-text-field__input" id="add-card-name-value">
							<div class="mdc-notched-outline">
								<div class="mdc-notched-outline__leading"></div>
								<div class="mdc-notched-outline__notch">
									<label for="add-card-name-value" class="mdc-floating-label">Action Name</label>
								</div>
								<div class="mdc-notched-outline__trailing"></div>
							</div>
						</div>
						<div class="mdc-select mdc-select--outlined" id="add-card-type" style="width: 100%; margin-top: 16px;">
							<i class="mdc-select__dropdown-icon"></i>
							<select class="mdc-select__native-control" id="add-card-select-widget">
								<option value=""></option>
							</select>
							<div class="mdc-notched-outline">
								<div class="mdc-notched-outline__leading"></div>
								<div class="mdc-notched-outline__notch">
									<label class="mdc-floating-label">Action</label>
								</div>
								<div class="mdc-notched-outline__trailing"></div>
							</div>
						</div>
					</div>
					<footer class="mdc-dialog__actions">
						<button type="button" class="mdc-button mdc-dialog__button" data-mdc-dialog-action="cancel">
							<span class="mdc-button__label">Cancel</span>
						</button>
						<button type="button" class="mdc-button mdc-dialog__button" data-mdc-dialog-action="add_card">
							<span class="mdc-button__label">Add Card</span>
						</button>
					</footer>
				</div>
			</div>
			<div class="mdc-dialog__scrim"></div>
		</div>

		<div class="mdc-dialog" role="alertdialog" aria-modal="true" id="add-sequence-dialog"  aria-labelledby="add-sequence-dialog-title" aria-describedby="add-sequence-dialog-content">
			<div class="mdc-dialog__container">
				<div class="mdc-dialog__surface">
					<h2 class="mdc-dialog__title" id="add-sequence-dialog-title">Add Sequence</h2>
					<div class="mdc-dialog__content" id="add-sequence-dialog-content">
						<div class="mdc-text-field mdc-text-field--outlined" id="add-sequence-name"  style="width: 100%; margin-top: 8px;">
							<input type="text" class="mdc-text-field__input" id="add-sequence-name-value">
							<div class="mdc-notched-outline">
								<div class="mdc-notched-outline__leading"></div>
								<div class="mdc-notched-outline__notch">
									<label for="add-card-name-value" class="mdc-floating-label">Sequence Name</label>
								</div>
								<div class="mdc-notched-outline__trailing"></div>
							</div>
						</div>
					</div>
					<footer class="mdc-dialog__actions">
						<button type="button" class="mdc-button mdc-dialog__button" data-mdc-dialog-action="cancel">
							<span class="mdc-button__label">Cancel</span>
						</button>
						<button type="button" class="mdc-button mdc-dialog__button" data-mdc-dialog-action="add_sequence">
							<span class="mdc-button__label">Add Sequence</span>
						</button>
					</footer>
				</div>
			</div>
			<div class="mdc-dialog__scrim"></div>
		</div>
    </body>
    
    <script>
        window.dialogBuilder = {
            cards: {{ game.interaction_card_modules_json }},
            source: '{{ game.definition_json }}',
            update: function(definition, success, failure) {
                var payload = {
                    'definition': JSON.stringify(definition, 2)
                };
                
                $.post("{% url 'builder_game' game.slug %}", payload, function(data) {
                	success();
                });
            }
        };
    </script>

    <script data-main="{% static 'builder-js/js/app/main.js' %}" src="{% static 'builder-js/vendor/require.js' %}"></script>
</html>
