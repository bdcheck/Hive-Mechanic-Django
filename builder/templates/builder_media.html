{% extends 'builder_base.html' %}
{% load static %}
{% load filer_admin_tags %}
{% load absolute_uri_tags %}
{% block 'page_title' %}All Media | Hive Mechanic{% endblock %}
{% block 'navigation_title' %}Hive Mechanic - Media Library{% endblock %}
{% block 'main_content' %}

    <script>
    let copyToClipboard = function(text) {
        navigator.clipboard.writeText(text).then(function () {
            alert("Url copied")
        }).catch(function () {
            alert("Error copying")
        });
    }
        $(document).ready(function() {
            $("#image-filter").on("keyup", function() {
            let val = $(this).val().toLowerCase()
            console.log(val)
            $(".image-grid").filter(function() {
                console.log(val)
                $(this).toggle($(this).data("name").toLowerCase().indexOf(val) > -1)
            });
        });
    });

    </script>
    <div id="clipboard-tooltip-id" class="mdc-tooltip" role="tooltip" aria-hidden="true">
        <div class="mdc-tooltip__surface mdc-tooltip__surface-animation">
            Copy to clipboard
        </div>
    </div>
    <div class="mdc-typography--headline5">
    Media Library
    </div>
    <div class="mdc-layout-grid mdc-layout-grid__cell--span-12">
    <div class="mdc-layout-grid__inner">
    <div class="mdc-layout-grid__cell--span-6">
    <div class="mdc-layout-grid">
        <label for="upload-field">Upload your file</label>
        <form method="post" enctype="multipart/form-data" action={% url 'builder_media_upload' %}>
                   {% csrf_token %}
            <input class="mdc-form-field" id="upload-field" type="file" name="file"/>
            <div>
            Description (optional): <input class="mdc-form-field" type="text" id = "description" name="description" >
            </div>
            <input type="submit" class="mdc-form-field">
        </form>
    </div>
    </div>
    <div class="mdc-layout-grid__cell--span-6">
    Filter: <input class="mdc-text-field" id="image-filter" placeholder="Search..">
    </div>
    </div>
    </div>
    <div>
	<ul class="mdc-list">
			{% for m in media %}
				<li class="mdc-list--two-line mdc-list-item mdc-list--thumbnail-list -card image-grid" data-name="{{ m.owner}} {{ m.uploaded_at }} {{ m.url }} {{ m.description }}"  >
							<span class="mdc-list-item mdc-list-item__graphic">
                               {% file_icon m %}
							</span>
                            <span class="mdc-deprecated-list-item__text">
                            {% if m.description %}
                            <span class="mdc-list-item__overline-text">
                                {{ m.description }}
                            </span>
                            {% endif %}
                            <span class="mdc-list-item__overline-text">
                               Owner: {{ m.owner }}
                            </span>

                                <span class="mdc-list-item__secondary-text">
                                    Uploaded at: {{ m.uploaded_at }}
                                </span>
                            <span class="mdc-list-item__secondary-text" style="font-size: 75%">
                                <a href="{% absolute_uri m.url request %}">{% absolute_uri m.url request %}</a>
							</span>
                            </span>
                            <span class="mdc-list-item mdc-deprecated-list-item__meta">
                                <button class="material-icons mdc-button" aria-describedby="clipboard-tooltip-id" onclick="copyToClipboard('{% absolute_uri m.url request %}')">content_copy</button>
                            </span>

            {%  endfor %}

        </li>
    </ul>
    </div>

{%  endblock %}
